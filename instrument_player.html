<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CË∞ÉÁ´πÁ¨õ</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      h1 {
        color: white;
        font-size: 3rem;
        text-align: center;
        margin: 20px 0 0 0;
        font-weight: 400;
        letter-spacing: 2px;
      }

      .container {
        background: rgba(255, 255, 255, 0.8);
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        width: 800px;
        margin-top: 20px;
      }

      .notes-row {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin: 15px 0;
        flex-wrap: wrap;
      }

      .note-button {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        border: 3px solid #a0aec0;
        background: linear-gradient(135deg, #e2e8f0 0%, #a0aec0 100%);
        color: #4a5568;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        box-shadow: 0 4px 15px rgba(160, 174, 192, 0.3);
      }

      .note-button:hover,
      .note-button:active,
      .note-button.pressed {
        box-shadow: 0 4px 15px rgba(192, 192, 192, 0.4);
        background: linear-gradient(135deg, #e2e8f0f1 0%, #cbd5e0 100%);
        border-color: #a0aec0;
        color: #4a5568;
      }

      .note-button .dot-top {
        position: absolute;
        top: 8px;
        width: 4px;
        height: 4px;
        background: #4a5568;
        border-radius: 50%;
        transition: background-color 0.3s ease;
      }

      .note-button .dot-bottom {
        position: absolute;
        bottom: 8px;
        width: 4px;
        height: 4px;
        background: #4a5568;
        border-radius: 50%;
        transition: background-color 0.3s ease;
      }

      .note-button:hover .dot-top,
      .note-button:hover .dot-bottom,
      .note-button:active .dot-top,
      .note-button:active .dot-bottom,
      .note-button.pressed .dot-top,
      .note-button.pressed .dot-bottom {
        background: #4a5568;
      }

      .input-section {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 25px 40px;
        margin: 20px auto;
        width: 800px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .input-section input,
      .input-section textarea {
        width: 100%;
        padding: 12px;
        margin: 8px 0;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 14px;
        font-family: "Arial", sans-serif;
        box-sizing: border-box;
      }

      .input-section textarea {
        height: 120px;
        resize: vertical;
        font-family: "Courier New", monospace;
      }

      .control-buttons {
        display: flex;
        gap: 15px;
        margin: 15px 0;
        flex-wrap: wrap;
        justify-content: center;
      }

      .control-buttons button {
        width: 100px;
        height: 40px;
        border: none;
        border-radius: 20px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        color: white;
      }

      #parseBtn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      #playBtn {
        background: linear-gradient(135deg, #56ab2f 0%, #46cb9a 100%);
      }

      #pauseBtn {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      }

      #stopBtn {
        background: linear-gradient(135deg, #ff8a80 0%, #ff5722 100%);
      }

      .control-buttons button:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .control-buttons button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      #playbackStatus {
        text-align: center;
        font-size: 16px;
        font-weight: bold;
        color: #4a5568;
        margin-top: 10px;
      }

      .note-button.auto-play {
        border: 3px solid #ff4444 !important;
        animation: pulse 0.5s ease-in-out infinite alternate;
        position: relative;
      }

      .note-button .duration-overlay {
        position: absolute;
        top: -25px;
        left: 50%;
        transform: translateX(-50%);
        background: #ff4444;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: bold;
        white-space: nowrap;
        z-index: 10;
      }

      .note-button .duration-overlay::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        border: 5px solid transparent;
        border-top-color: #ff4444;
      }

      @keyframes pulse {
        from {
          box-shadow: 0 0 10px rgba(255, 68, 68, 0.5);
        }
        to {
          box-shadow: 0 0 20px rgba(255, 68, 68, 0.8);
        }
      }
    </style>
  </head>
  <body>
    <h1>üéµ CË∞ÉÁ´πÁ¨õÊºîÂ•è üéµ</h1>

    <div class="input-section">
      <textarea id="sheetMusic" placeholder="ËØ∑ËæìÂÖ•ÁÆÄË∞±Êï∞ÁªÑÔºåÊ†ºÂºè: [[Èü≥Á¨¶, ÂÖ´Â∫¶, Êó∂ÂÄºÔºàÁßíÔºâ, ÊòØÂê¶ËøûÈü≥], ...]&#10;Á§∫‰æãÔºö[['1', 'mid', 0.5, false], ['2', 'mid', 0.5, false], ['3', 'mid', 1.0, false]]"></textarea>
      <div class="control-buttons">
        <button id="parseBtn" onclick="parseSheetMusic()">Ëß£ÊûêÁÆÄË∞±</button>
        <button id="playBtn" onclick="startAutoPlay()" disabled>ÂºÄÂßãÊºîÂ•è</button>
        <button id="pauseBtn" onclick="pauseAutoPlay()" disabled>ÊöÇÂÅú</button>
        <button id="stopBtn" onclick="stopAutoPlay()" disabled>ÂÅúÊ≠¢</button>
      </div>
      <div id="playbackStatus"></div>
    </div>

    <div class="container">
      <!-- È´òÈü≥Âå∫ -->
      <div class="notes-row">
        <button class="note-button" onclick="playNote('high', 1)">
          <div class="dot-top"></div>
          1
        </button>
        <button class="note-button" onclick="playNote('high', 2)">
          <div class="dot-top"></div>
          2
        </button>
        <button class="note-button" onclick="playNote('high', 3)">
          <div class="dot-top"></div>
          3
        </button>
        <button class="note-button" onclick="playNote('high', 4)">
          <div class="dot-top"></div>
          4
        </button>
        <button class="note-button" onclick="playNote('high', 5)">
          <div class="dot-top"></div>
          5
        </button>
        <button class="note-button" onclick="playNote('high', 6)">
          <div class="dot-top"></div>
          6
        </button>
        <button class="note-button" onclick="playNote('high', 7)">
          <div class="dot-top"></div>
          7
        </button>
      </div>

      <!-- ‰∏≠Èü≥Âå∫ -->
      <div class="notes-row">
        <button class="note-button" onclick="playNote('mid', 1)">1</button>
        <button class="note-button" onclick="playNote('mid', 2)">2</button>
        <button class="note-button" onclick="playNote('mid', 3)">3</button>
        <button class="note-button" onclick="playNote('mid', 4)">4</button>
        <button class="note-button" onclick="playNote('mid', 5)">5</button>
        <button class="note-button" onclick="playNote('mid', 6)">6</button>
        <button class="note-button" onclick="playNote('mid', 7)">7</button>
      </div>

      <!-- ‰ΩéÈü≥Âå∫ -->
      <div class="notes-row">
        <button class="note-button" onclick="playNote('low', 1)">
          1
          <div class="dot-bottom"></div>
        </button>
        <button class="note-button" onclick="playNote('low', 2)">
          2
          <div class="dot-bottom"></div>
        </button>
        <button class="note-button" onclick="playNote('low', 3)">
          3
          <div class="dot-bottom"></div>
        </button>
        <button class="note-button" onclick="playNote('low', 4)">
          4
          <div class="dot-bottom"></div>
        </button>
        <button class="note-button" onclick="playNote('low', 5)">
          5
          <div class="dot-bottom"></div>
        </button>
        <button class="note-button" onclick="playNote('low', 6)">
          6
          <div class="dot-bottom"></div>
        </button>
        <button class="note-button" onclick="playNote('low', 7)">
          7
          <div class="dot-bottom"></div>
        </button>
      </div>
    </div>

    <script>
      // È¢ÑÂä†ËΩΩÈü≥È¢ëÊñá‰ª∂
      const audioCache = {};
      let currentPlayingAudio = null;
      let fadeOutTimeout = null;
      let isPlaying = false;
      let currentRange = null;
      let currentNote = null;
      let pressedKeys = new Set();

      function preloadAudio() {
        const ranges = ["high", "mid", "low"];
        const notes = [1, 2, 3, 4, 5, 6, 7];

        ranges.forEach(range => {
          audioCache[range] = {};
          notes.forEach(note => {
            const audio = new Audio(`${range}/${note}.wav`);
            audio.preload = "auto";
            audio.loop = true; // ËÆæÁΩÆÂæ™ÁéØÊí≠Êîæ
            audioCache[range][note] = audio;
          });
        });
      }

      function fadeOutAudio(audio, duration = 500) {
        if (!audio) return;

        const startVolume = audio.volume;
        const fadeStep = startVolume / (duration / 10);

        const fade = setInterval(() => {
          if (audio.volume > fadeStep) {
            audio.volume -= fadeStep;
          } else {
            audio.volume = 0;
            audio.pause();
            audio.currentTime = 0;
            audio.volume = 1; // ÈáçÁΩÆÈü≥Èáè
            clearInterval(fade);
          }
        }, 10);
      }

      function startNote(range, note) {
        // Â¶ÇÊûúÂ∑≤ÁªèÂú®Êí≠ÊîæÁõ∏ÂêåÁöÑÈü≥Á¨¶ÔºåÁõ¥Êé•ËøîÂõû
        if (isPlaying && currentRange === range && currentNote === note) {
          return;
        }

        // ÂÅúÊ≠¢ÂΩìÂâçÊí≠ÊîæÁöÑÈü≥È¢ë
        stopCurrentNote();

        try {
          const audio = audioCache[range][note];
          if (audio) {
            audio.currentTime = 0;
            audio.volume = 1;
            currentPlayingAudio = audio;
            currentRange = range;
            currentNote = note;
            isPlaying = true;

            audio.play().catch(error => {
              console.error("Êí≠ÊîæÈü≥È¢ëÂ§±Ë¥•:", error);
              // Â§áÁî®ÊñπÊ°à
              const fallbackAudio = new Audio(`${range}/${note}.wav`);
              fallbackAudio.loop = true;
              fallbackAudio.play().catch(fallbackError => {
                console.error("Â§áÁî®Èü≥È¢ëÊí≠Êîæ‰πüÂ§±Ë¥•:", fallbackError);
              });
              currentPlayingAudio = fallbackAudio;
            });
          } else {
            console.error("Èü≥È¢ëÊñá‰ª∂Êú™ÊâæÂà∞:", `${range}/${note}.wav`);
          }
        } catch (error) {
          console.error("Êí≠ÊîæÈü≥È¢ëÊó∂Âá∫Èîô:", error);
        }
      }

      function stopCurrentNote() {
        if (currentPlayingAudio && isPlaying) {
          // Ê∏ÖÈô§‰πãÂâçÁöÑÊ∑°Âá∫ÂÆöÊó∂Âô®
          if (fadeOutTimeout) {
            clearTimeout(fadeOutTimeout);
          }

          fadeOutAudio(currentPlayingAudio, 500);
          currentPlayingAudio = null;
          currentRange = null;
          currentNote = null;
          isPlaying = false;
        }
      }

      function playNote(range, note) {
        startNote(range, note);
      }

      function getButtonByNote(range, note) {
        const buttons = document.querySelectorAll(".note-button");
        for (let button of buttons) {
          if (button.onclick && button.onclick.toString().includes(`'${range}', ${note}`)) {
            return button;
          }
        }
        return null;
      }

      // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÈ¢ÑÂä†ËΩΩÈü≥È¢ë
      window.addEventListener("load", preloadAudio);

      // Èº†Ê†á‰∫ã‰ª∂Â§ÑÁêÜ
      document.querySelectorAll(".note-button").forEach(button => {
        button.addEventListener("mousedown", function (event) {
          event.preventDefault();
          const onclickStr = this.onclick.toString();
          const match = onclickStr.match(/playNote\('(\w+)', (\d+)\)/);
          if (match) {
            const range = match[1];
            const note = parseInt(match[2]);
            startNote(range, note);
            this.classList.add("pressed");
          }
        });

        button.addEventListener("mouseup", function () {
          stopCurrentNote();
          this.classList.remove("pressed");
        });

        button.addEventListener("mouseleave", function () {
          stopCurrentNote();
          this.classList.remove("pressed");
        });
      });

      // ÈîÆÁõòÊîØÊåÅ
      document.addEventListener("keydown", function (event) {
        const keyMap = {
          1: { range: "mid", note: 1 },
          2: { range: "mid", note: 2 },
          3: { range: "mid", note: 3 },
          4: { range: "mid", note: 4 },
          5: { range: "mid", note: 5 },
          6: { range: "mid", note: 6 },
          7: { range: "mid", note: 7 },
          q: { range: "high", note: 1 },
          w: { range: "high", note: 2 },
          e: { range: "high", note: 3 },
          r: { range: "high", note: 4 },
          t: { range: "high", note: 5 },
          y: { range: "high", note: 6 },
          u: { range: "high", note: 7 },
          a: { range: "low", note: 1 },
          s: { range: "low", note: 2 },
          d: { range: "low", note: 3 },
          f: { range: "low", note: 4 },
          g: { range: "low", note: 5 },
          h: { range: "low", note: 6 },
          j: { range: "low", note: 7 },
        };

        const key = event.key.toLowerCase();
        const mapping = keyMap[key];

        if (mapping && !pressedKeys.has(key)) {
          event.preventDefault();
          pressedKeys.add(key);
          startNote(mapping.range, mapping.note);

          // Ê∑ªÂä†ËßÜËßâÂèçÈ¶à
          const button = getButtonByNote(mapping.range, mapping.note);
          if (button) {
            button.classList.add("pressed");
          }
        }
      });

      document.addEventListener("keyup", function (event) {
        const key = event.key.toLowerCase();
        const keyMap = {
          1: { range: "mid", note: 1 },
          2: { range: "mid", note: 2 },
          3: { range: "mid", note: 3 },
          4: { range: "mid", note: 4 },
          5: { range: "mid", note: 5 },
          6: { range: "mid", note: 6 },
          7: { range: "mid", note: 7 },
          q: { range: "high", note: 1 },
          w: { range: "high", note: 2 },
          e: { range: "high", note: 3 },
          r: { range: "high", note: 4 },
          t: { range: "high", note: 5 },
          y: { range: "high", note: 6 },
          u: { range: "high", note: 7 },
          a: { range: "low", note: 1 },
          s: { range: "low", note: 2 },
          d: { range: "low", note: 3 },
          f: { range: "low", note: 4 },
          g: { range: "low", note: 5 },
          h: { range: "low", note: 6 },
          j: { range: "low", note: 7 },
        };

        const mapping = keyMap[key];
        if (mapping && pressedKeys.has(key)) {
          pressedKeys.delete(key);

          // Âè™ÊúâÂΩìÊùæÂºÄÁöÑÈîÆÂØπÂ∫îÂΩìÂâçÊí≠ÊîæÁöÑÈü≥Á¨¶Êó∂ÊâçÂÅúÊ≠¢
          if (currentRange === mapping.range && currentNote === mapping.note) {
            stopCurrentNote();
          }

          // ÁßªÈô§ËßÜËßâÂèçÈ¶à
          const button = getButtonByNote(mapping.range, mapping.note);
          if (button) {
            button.classList.remove("pressed");
          }
        }
      });

      // Èò≤Ê≠¢È°µÈù¢Â§±ÂéªÁÑ¶ÁÇπÊó∂Èü≥È¢ëÁªßÁª≠Êí≠Êîæ
      window.addEventListener("blur", function () {
        stopCurrentNote();
        pressedKeys.clear();
        document.querySelectorAll(".note-button").forEach(button => {
          button.classList.remove("pressed");
        });
      });

      // ========== ÁÆÄË∞±Ëß£ÊûêÂíåËá™Âä®ÊºîÂ•èÂäüËÉΩ ==========
      let parsedSheetMusic = [];
      let autoPlayInterval = null;
      let currentNoteIndex = 0;
      let isAutoPlaying = false;
      let isPaused = false;
      let currentAutoPlayTimeout = null;

      function parseSheetMusic() {
        const input = document.getElementById("sheetMusic").value.trim();
        const statusDiv = document.getElementById("playbackStatus");

        if (!input) {
          statusDiv.textContent = "ËØ∑ËæìÂÖ•ÁÆÄË∞±Êï∞ÁªÑ";
          statusDiv.style.color = "#ff4444";
          return;
        }

        try {
          // Â∞ùËØïËß£ÊûêJSONÊï∞ÁªÑ
          parsedSheetMusic = JSON.parse(input);
          // È™åËØÅÊï∞ÊçÆÊ†ºÂºè
          if (!Array.isArray(parsedSheetMusic)) {
            throw new Error("ËæìÂÖ•ÂøÖÈ°ªÊòØÊï∞ÁªÑÊ†ºÂºè");
          }

          for (let i = 0; i < parsedSheetMusic.length; i++) {
            const note = parsedSheetMusic[i];
            if (!Array.isArray(note) || note.length !== 4) {
              throw new Error(`Á¨¨${i + 1}‰∏™Èü≥Á¨¶Ê†ºÂºèÈîôËØØÔºåÂ∫î‰∏∫[Èü≥Á¨¶, ÂÖ´Â∫¶, Êó∂ÂÄº, ËøûÈü≥]`);
            }

            const [noteName, octave, duration, isSlur] = note;
            if (noteName !== "rest" && !["1", "2", "3", "4", "5", "6", "7"].includes(noteName)) {
              throw new Error(`Á¨¨${i + 1}‰∏™Èü≥Á¨¶"${noteName}"Êó†ÊïàÔºåÂ∫î‰∏∫1-7Êàñrest`);
            }

            if (noteName !== "rest" && !["low", "mid", "high"].includes(octave)) {
              throw new Error(`Á¨¨${i + 1}‰∏™Èü≥Á¨¶ÂÖ´Â∫¶"${octave}"Êó†ÊïàÔºåÂ∫î‰∏∫low/mid/high`);
            }

            if (typeof duration !== "number" || duration <= 0) {
              throw new Error(`Á¨¨${i + 1}‰∏™Èü≥Á¨¶Êó∂ÂÄºÊó†ÊïàÔºåÂ∫î‰∏∫Ê≠£Êï∞`);
            }
          }

          statusDiv.textContent = `ÁÆÄË∞±Ëß£ÊûêÊàêÂäüÔºÅÂÖ±${parsedSheetMusic.length}‰∏™Èü≥Á¨¶`;
          statusDiv.style.color = "#56ab2f";

          // ÂêØÁî®Êí≠ÊîæÊåâÈíÆ
          document.getElementById("playBtn").disabled = false;
        } catch (error) {
          statusDiv.textContent = `Ëß£ÊûêÈîôËØØ: ${error.message}`;
          statusDiv.style.color = "#ff4444";
          parsedSheetMusic = [];
          document.getElementById("playBtn").disabled = true;
        }
      }

      function startAutoPlay() {
        if (parsedSheetMusic.length === 0) {
          document.getElementById("playbackStatus").textContent = "ËØ∑ÂÖàËß£ÊûêÁÆÄË∞±";
          return;
        }

        isAutoPlaying = true;
        isPaused = false;
        currentNoteIndex = 0;

        // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
        document.getElementById("playBtn").disabled = true;
        document.getElementById("pauseBtn").disabled = false;
        document.getElementById("stopBtn").disabled = false;

        playNextNote();
      }

      function pauseAutoPlay() {
        if (!isAutoPlaying) return;

        isPaused = !isPaused;

        if (isPaused) {
          // ÊöÇÂÅú
          if (currentAutoPlayTimeout) {
            clearTimeout(currentAutoPlayTimeout);
            currentAutoPlayTimeout = null;
          }
          stopCurrentNote();
          clearAllVisualHints();
          document.getElementById("pauseBtn").textContent = "ÁªßÁª≠";
          document.getElementById("playbackStatus").textContent = "ÊºîÂ•èÂ∑≤ÊöÇÂÅú";
        } else {
          // ÁªßÁª≠
          document.getElementById("pauseBtn").textContent = "ÊöÇÂÅú";
          playNextNote();
        }
      }

      function stopAutoPlay() {
        isAutoPlaying = false;
        isPaused = false;
        currentNoteIndex = 0;

        if (currentAutoPlayTimeout) {
          clearTimeout(currentAutoPlayTimeout);
          currentAutoPlayTimeout = null;
        }

        stopCurrentNote();
        clearAllVisualHints();

        // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
        document.getElementById("playBtn").disabled = false;
        document.getElementById("pauseBtn").disabled = true;
        document.getElementById("pauseBtn").textContent = "ÊöÇÂÅú";
        document.getElementById("stopBtn").disabled = true;

        document.getElementById("playbackStatus").textContent = "ÊºîÂ•èÂ∑≤ÂÅúÊ≠¢";
      }

      function playNextNote() {
        if (!isAutoPlaying || isPaused || currentNoteIndex >= parsedSheetMusic.length) {
          if (currentNoteIndex >= parsedSheetMusic.length) {
            // ÊºîÂ•èÂÆåÊàê
            stopAutoPlay();
            document.getElementById("playbackStatus").textContent = "ÊºîÂ•èÂÆåÊàêÔºÅ";
          }
          return;
        }

        const [noteName, octave, duration, isSlur] = parsedSheetMusic[currentNoteIndex];

        // Êõ¥Êñ∞Áä∂ÊÄÅÊòæÁ§∫
        document.getElementById("playbackStatus").textContent = `ÊºîÂ•è‰∏≠... (${currentNoteIndex + 1}/${parsedSheetMusic.length})`;

        if (noteName === "rest") {
          // ‰ºëÊ≠¢Á¨¶Ôºå‰∏çÊí≠ÊîæÈü≥È¢ë‰ΩÜ‰ªçÈúÄÁ≠âÂæÖÊó∂Èó¥
          currentAutoPlayTimeout = setTimeout(() => {
            currentNoteIndex++;
            playNextNote();
          }, duration * 1000);
        } else {
          // ÊâæÂà∞ÂØπÂ∫îÁöÑÊåâÈíÆÂπ∂Ê∑ªÂä†ËßÜËßâÊèêÁ§∫
          const button = getButtonByNote(octave, parseInt(noteName));
          if (button) {
            showNoteHint(button, duration);

            // Êí≠ÊîæÈü≥Á¨¶
            startNote(octave, parseInt(noteName));

            // ËÆæÁΩÆÂÆöÊó∂Âô®Êí≠Êîæ‰∏ã‰∏Ä‰∏™Èü≥Á¨¶
            currentAutoPlayTimeout = setTimeout(() => {
              if (!isSlur) {
                stopCurrentNote();
              }
              removeNoteHint(button);
              currentNoteIndex++;
              playNextNote();
            }, duration * 1000);
          } else {
            console.error(`Êâæ‰∏çÂà∞Èü≥Á¨¶ ${noteName}(${octave}) ÂØπÂ∫îÁöÑÊåâÈíÆ`);
            currentNoteIndex++;
            playNextNote();
          }
        }
      }

      function showNoteHint(button, duration) {
        // Ê∑ªÂä†Á∫¢Ëâ≤ËæπÊ°ÜÂíåËÑâÂÜ≤Âä®Áîª
        button.classList.add("auto-play");

        // ÂàõÂª∫Êó∂Èó¥ÊòæÁ§∫Ë¶ÜÁõñÂ±Ç
        const overlay = document.createElement("div");
        overlay.className = "duration-overlay";
        overlay.textContent = `${duration}s`;
        button.appendChild(overlay);
      }

      function removeNoteHint(button) {
        button.classList.remove("auto-play");
        const overlay = button.querySelector(".duration-overlay");
        if (overlay) {
          overlay.remove();
        }
      }

      function clearAllVisualHints() {
        document.querySelectorAll(".note-button").forEach(button => {
          removeNoteHint(button);
        });
      }

      // Ê∑ªÂä†ÈªòËÆ§Á§∫‰æã
      window.addEventListener("load", function () {
        const defaultExample = `[
          ["1", "mid", 0.5, false],
          ["2", "mid", 0.5, false], 
          ["3", "mid", 0.5, false],
          ["4", "mid", 0.5, false],
          ["5", "mid", 1.0, false],
          ["rest", "", 0.5, false],
          ["5", "mid", 0.5, false],
          ["6", "mid", 0.5, false],
          ["7", "mid", 1.0, false]
        ]`;
        document.getElementById("sheetMusic").value = defaultExample;
      });
    </script>
  </body>
</html>
